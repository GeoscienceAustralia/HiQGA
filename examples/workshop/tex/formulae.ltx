\documentclass[9pt]{amsart}
\usepackage[a4paper,
             left=0.4in,
            right=0.4in,
            top=0.3in,
            bottom=0.3in,
            ]{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{epstopdf}
\usepackage[hyphens]{url}
\usepackage{hyperref}
\usepackage{natbib}
\usepackage{enumitem}
\usepackage{physics}
\setlist{topsep=1.5em, itemsep=1em}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{For August 2022 Workshop}
%\author{Anandaroop Ray}
%\date{}                                           % Activate to display a given date or no date

\begin{document}
\maketitle
\section{Linearization}\label{summary}
\begin{align}
\intertext{Expanding to first order about $\mathbf x$:}
\mathbf {f(x+\Delta x)} &\approx \mathbf {f(x)} +\mathbf{J}\mathbf{\Delta x,}
\intertext{where Jacobian $\mathbf{J} \in \mathbb R^{n_f \times n_x}$. Now writing residual $\mathbf r = \mathbf {f(x+\Delta x)} - \mathbf {f(x)} \approx \mathbf{d - f(x)}$,}
\mathbf{J}\mathbf{\Delta x} &= \mathbf r,
\intertext{which is a linear least squares problem with solution:}
\mathbf{\Delta x} &= (\mathbf{J}^t \mathbf{J})^{-1} \mathbf{J}^t\mathbf{r}
\intertext{For an objective function $\phi = \mathbf{||d-f(x)||}$, you can prove with a little multivariable calculus that gradient $\nabla_x \phi= -\mathbf{J}^t\mathbf{r}$, which sort of all begins to make sense now, as the new} 
\mathbf x' &= \mathbf x-\gamma\nabla_x\phi\\
\mathbf x' &= \mathbf x + \mathbf{\Delta x}
\end{align}
with Hessian inverse approximated by $(\mathbf{J}^t \mathbf{J})^{-1}$ as step length $\gamma$. The direction to walk down (since gradient points up) can be identified with $-\nabla_x\phi$ given by $\mathbf{J}^t\mathbf{r}$. If we are not in the vicinity of the minimum we repeat this step various times, with a new linearization about $\mathbf x'$.
%\subsection{}
%
\section{A system}
\begin{equation}
\begin{bmatrix}
y_1\\
y_2\\
y_3\\
\vdots\\
y_n 
\end{bmatrix} = 
\begin{bmatrix}
1&0&\cdots &0 &0 \\
0&1&\cdots &0 &0\\
\vdots & \vdots & \ddots & \vdots &\vdots\\
0&0&\cdots &1 &0\\
0&0&\cdots &0 &1
\end{bmatrix} 
\begin{bmatrix}
x_1\\
x_2\\
x_3\\
\vdots\\
x_n 
\end{bmatrix} 
\end{equation}

\begin{equation}
\begin{bmatrix}
y_2\\
\end{bmatrix} = 
\begin{bmatrix}
0&1&\cdots&0\\
\end{bmatrix} 
\begin{bmatrix}
x_1\\
x_2\\
x_3\\
\vdots\\
x_n 
\end{bmatrix} 
= [\:\mathbf{e}_2\:] \begin{bmatrix}
x_1\\
x_2\\
x_3\\
\vdots\\
x_n 
\end{bmatrix} 
\end{equation}

\begin{equation}
\begin{bmatrix}
y_2\\
y_4\\
y_{9}\\
\end{bmatrix} = 
\begin{bmatrix}
\:\mathbf{e}_2\:\\
\:\mathbf{e}_4\:\\
\:\mathbf{e}_{9}\:\\
\end{bmatrix} 
\begin{bmatrix}
x_1\\
x_2\\
x_3\\
\vdots\\
x_n
\end{bmatrix} 
\end{equation}

\begin{align}
\phi &= \mathbf{||y - Ax||}^2,\\
\text {set}\; \nabla_x \phi &= 0,\\
\mathbf{\hat x} &=(\mathbf{A^tA})^{-1}\mathbf{A^td}.
\end{align}

\begin{align}
\mathbf{\hat x_\text{ridge}} &=(\mathbf{A^tA} + \delta^2 \mathbf I)^{-1}\mathbf{A^td}.
\end{align}

\begin{equation}
\begin{bmatrix}
\;&0&\; &\; &\; \\
-1&1&\;&0 &\;\\
\;&-1&1 &\; &\;\\
\;&\;&\; &\hdots &\; \\
\;&0&\; &-1 &1
\end{bmatrix} 
\begin{bmatrix}
x_1\\
x_2\\
x_3\\
\vdots\\
x_n 
\end{bmatrix} = \begin{bmatrix}
0\\
-x_1+x_2\\
-x_2+x_3\\
\vdots\\
-x_{n-1}x_n 
\end{bmatrix}
\end{equation}

\begin{align}
\phi &= \mathbf{||y - Ax||}^2 + \lambda^2||\mathbf{Rx}||^2,\\
\text {set}\; \nabla_x \phi &= 0,\\
\mathbf{\hat x_\text{smooth}} &=(\mathbf{A^tA + \lambda^2R^tR})^{-1}\mathbf{A^td}\\
\mathbf{\hat x_\text{occam}} &=(\mathbf{A^tA + \lambda^2R^tR})^{-1}\mathbf{A^td}.
\end{align}

\begin{align}
k_i^2 &= k_{r}^2 + k_{i_z}^2,\\
&= \hat\epsilon_i\mu\omega^2,\\
\text{where\;}\hat\epsilon_i &= \epsilon_i + i\sigma_i/\omega. \text{\;But for most geophysics ...}\\
%\text{but for geophysical frequencies,}\\
k_i^2 &= \epsilon_i\mu\omega^2 + i\omega\mu\sigma_i\\
&\approx i\omega\mu\sigma_i
\end{align}

\begin{align}
\mathbf d = \mathbf{f(m)}
\end{align}

\begin{align}
&\phi (\mathbf m) = \frac 1 2\Big(\mathbf{||d - f(m)||}^2 + \lambda^2||\mathbf{Rm}||^2\Big),\\
&\text {but how to set}\; \nabla_m \phi = 0\text{\;?}\\
&\text{\textit{linearize }} \phi (\mathbf m) \text{\;to\;} \phi (\mathbf {m + \Delta m}) \text{\;i.e.,}\\
&\mathbf{f(m)} \rightarrow \mathbf{f(m + \Delta m)},  \mathbf{Rm} \rightarrow \mathbf{R(m+\Delta m)} \text{\;first}.\\
\Aboxed{&\mathbf{f(m + \Delta m)}  \approx \mathbf {f(m)} +\mathbf{J}\mathbf{\Delta m}.}
\end{align}

\begin{align}
&\text{first write residual\;} \mathbf r \approx \mathbf{f(m) - d}\\
&\text{derive with respect to $\Delta \mathbf m$,} \\
&\text{set\;}\pdv{\phi}{\mathbf {\Delta m}} = 0,\text{ giving,}\\
\Aboxed{&\mathbf {\Delta m} =  -\Big(\mathbf{J}^t\mathbf{J} + \lambda^2\mathbf{R}^t{\mathbf R}\Big)^{-1} \Big(\mathbf{J}^t\mathbf{r} + \lambda^2\mathbf{R}^t\mathbf{Rm}\Big)}\\
&\text{note also, that }\nabla_m \phi = \mathbf{J}^t\mathbf{r} + \lambda^2\mathbf{R}^t\mathbf{Rm}.\\
&\text{note finally, that }\pdv{(\nabla_m \phi)}{\mathbf {m}}= \mathbf{J}^t\mathbf{J} + \lambda^2\mathbf{R}^t\mathbf{R}.
\end{align}

\begin{align}
\Aboxed{&\mathbf{m}_\text{new} = \mathbf{m} + \mathbf{\Delta m}}\\
&\text{writing }\nabla_m \phi = \mathbf{J}^t\mathbf{r} + \lambda^2\mathbf{R}^t\mathbf{Rm},\\
&\text{and }\eta = \Big(\mathbf{J}^t\mathbf{J} + \lambda^2\mathbf{R}^t\mathbf{R}\Big)^{-1} \text{ we now say},\\
\Aboxed{&\mathbf{m}_\text{new} = \mathbf{m} - \eta\nabla_m \phi}
\end{align}

\bibliographystyle{named}
\bibliography{/Users/anray/Documents/library}
\end{document}  